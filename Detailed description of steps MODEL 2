1. Цель модели

Модель должна:

Обрабатывать данные из объединённого датасета (кардиология, сердечная недостаточность, другие сердечно-сосудистые заболевания).

На выходе выдавать вещественное число от 0 до 1 — вероятность того, что у человека есть сердечно-сосудистое заболевание.

Поддерживать интерпретируемость и быть простой для быстрого тестирования на новых примерах.

2. Декомпозиция задачи

Подготовка данных

Привести все датасеты к общим признакам.

Преобразовать возраст и привести все значения к числовому виду.

Объединить данные в единый DataFrame.

Масштабирование и разбиение

Стандартизировать признаки с помощью StandardScaler.

Разделить данные на train/validation/test.

Создание тензоров и DataLoader

Преобразовать numpy-массивы в torch.tensor.

Создать TensorDataset и DataLoader для батчевой обработки.

Построение модели

Использовать MLP (Multi-Layer Perceptron) с двумя скрытыми слоями и функцией активации ReLU.

Последний слой — один нейрон с Sigmoid, чтобы выход был в диапазоне 0–1.

Выбор функции потерь и оптимизатора

Потеря: BCELoss — Binary Cross-Entropy, стандарт для вероятностной бинарной классификации.

Оптимизатор: SGD или Adam для обновления весов.

Функция обучения

Итерация по батчам.

Вычисление предсказания, потерь, градиентов, обновление весов.

Отслеживание метрик: loss, accuracy (с порогом 0.5).

Тестирование и предсказание вероятности

Использовать model.eval() и torch.no_grad().

Вероятность = выход сигмоиды.

Для метрики accuracy можно применить порог 0.5, но для аналитики оставляем реальное число 0–1.

4. Объяснение выбора архитектуры

MLP с двумя скрытыми слоями — оптимальный компромисс между сложностью и обучаемостью для небольшого количества признаков (~8).

ReLU — стандартная активация для скрытых слоёв, предотвращает затухающие градиенты.

Sigmoid на выходе — гарантирует вещественное значение от 0 до 1, интерпретируемое как вероятность болезни.

BCELoss + Adam — стандартная комбинация для обучения вероятностной бинарной классификации.

5. Преимущества такой модели

Простая, быстрая в обучении.

Вероятностный вывод для каждого человека.

Можно использовать для ранжирования пациентов по риску и построения ROC-кривой.

Легко тестировать на новых данных.
